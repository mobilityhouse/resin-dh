From d3f9829a37661749b200760ad6525f77cf77d77a Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Nikola=20Forr=C3=B3?= <nforro@redhat.com>
Date: Mon, 11 Jul 2016 16:04:34 +0200
Subject: [PATCH 4/8] Fix CVE-2016-3632

CVE-2016-3632 libtiff: The _TIFFVGetField function in tif_dirinfo.c in
LibTIFF 4.0.6 and earlier allows remote attackers to cause a denial of service
(out-of-bounds write) or execute arbitrary code via a crafted TIFF image.

CVE: CVE-2016-3632
Upstream-Status: Backport [RedHat RHEL7]

Signed-off-by: Yi Zhao <yi.zhao@windirver.com>
---
 tools/thumbnail.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/tools/thumbnail.c b/tools/thumbnail.c
index fd1cba5..75e7009 100644
--- a/tools/thumbnail.c
+++ b/tools/thumbnail.c
@@ -253,7 +253,8 @@ static struct cpTag {
     { TIFFTAG_WHITEPOINT,		2, TIFF_RATIONAL },
     { TIFFTAG_PRIMARYCHROMATICITIES,	(uint16) -1,TIFF_RATIONAL },
     { TIFFTAG_HALFTONEHINTS,		2, TIFF_SHORT },
-    { TIFFTAG_BADFAXLINES,		1, TIFF_LONG },
+    // disable BADFAXLINES, CVE-2016-3632
+    //{ TIFFTAG_BADFAXLINES,		1, TIFF_LONG },
     { TIFFTAG_CLEANFAXDATA,		1, TIFF_SHORT },
     { TIFFTAG_CONSECUTIVEBADFAXLINES,	1, TIFF_LONG },
     { TIFFTAG_INKSET,			1, TIFF_SHORT },
-- 
2.7.4

